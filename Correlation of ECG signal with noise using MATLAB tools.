x1 = 3.7*ecg(3000).';
y1 = sgolayfilt(kron(ones(1,13),x1),0,21);
n = 1:30000;
del = round(3000*rand(1));
mhb = y1(n+del); %mhb = Maternal Heart Beat
t = 0.00025:0.00025:7.5;
subplot(2,3,1);
plot(t,mhb);
axis([0 2.5 -4 4]);
grid;
xlabel('Time [sec]');
ylabel('Voltage [mV]');
title('Maternal Heartbeat Signal');
c = xcorr(mhb,mhb);
subplot(2,3,2);
plot(c);
axis([0 60000 -10000 20000]);
grid;
xlabel('No. of Samples');
ylabel('Auto-Correlation');
title('Auto-Correlation of ECG Signal');
d = rand(1,length(mhb));
subplot(2,3,3);
plot(d);
xlabel('No. of Samples');
ylabel('Error Signal');
title('Noise Signal');
p=xcorr(d,d);
subplot(2,3,4);
plot(p);
grid;
xlabel('No. of Samples');
ylabel('Auto-Correlation');
title('Auto-Correlation of Noise Signal');
y = mhb+d;
subplot(2,3,5);
plot(y);
axis([0 30000 -4 5]);
grid;
xlabel('No. of Samples');
ylabel('Addition');
title('Combination of Original Signal & Noise Signal');
r = xcorr(y,y);
subplot(2,3,6);
plot(r);
axis([0 60000 -5000 35000]);
grid;
xlabel('No. of Samples');
ylabel('Cross Correlation');
title('Corrupted Signal');
